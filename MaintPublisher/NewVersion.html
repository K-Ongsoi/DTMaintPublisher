<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Technical Department : Document Editor Page">
    <meta name="author" content="Keerati Ongsoi" />

    <title>THAI - Technical Department : Document Editor Page</title>
    <link rel="icon" href="images/favicon.png" />
    <link href="framework/jqwidgets/styles/jqx.base.css" rel="stylesheet" />
    <link href="framework/jqwidgets/styles/jqx.web.css" rel="stylesheet" />
    <link href="framework/bootstrap4/css/bootstrap.min.css" rel="stylesheet" />
    <link href="framework/css/all.css" rel="stylesheet" />
    <link href="style/fonts.css" rel="stylesheet" />
    <link href="style/master.css" rel="stylesheet" />
    <link href="framework/bootstrap4/css/open-iconic-bootstrap.css" rel="stylesheet" />
    <link href="framework/bootstrap4/css/bootstrap-multiselect.css" rel="stylesheet" />
    <link href="framework/css/jquery.fileupload.css" rel="stylesheet" />
    <link href="content/toastr.min.css" rel="stylesheet" />
    <script src="framework/moment.js"></script>
</head>
<body>
    <nav class="navbar sticky-top flex-md-nowrap p-0" role="navigation">
        <a class="navbar-brand" href="LandingPage.html"><img src="images/LightLogo.png" /></a>
        <div class="col-sm-2 col-md-2 mr-0 navbar page-title" style="float: left;">Document Editors</div>
        <div class="w-100" style="align-content:center;text-align:center;"><img src="images/DarkLogo.png" style="vertical-align: central;" />TECHNICAL DEPARTMENT</div>
        <div class="col-sm-2 col-md-2">
            <div class="navbar-nav px-2" style="float:right;">
                <a href="#" role="button"><i class="fas fa-user-circle" style="vertical-align:middle;color:#808080;"></i><span class="user-name">&nbsp; Keerati Ongsoi</span></a>
            </div>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <nav class="d-none d-md-block bg-light sidebar">
                <div class="sidebar-sticky">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" title="Document Editor">
                                <span data-feather="home"></span>
                                <i class="far fa-clipboard fa-2x"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" title="Log out">
                                <span data-feather="file"></span>
                                <i class="fas fa-sign-out-alt fa-2x"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <main role="main" class="main col-md-11 ml-sm-auto col-lg-12 pt-0 px-5 mh-100 h-100" style="position:page;">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap border-bottom">
                <nav class="nav" style="float:left;">
                    <a class="nav-link" href="DocEditor.html"><i class="far fa-file"></i> New Document</a>
                    <a class="nav-link active" href="#"><i class="far fa-copy"></i> Document Viewer</a>
                </nav>
            </div>
            <span class="pageTitle"><i class="far fa-copy"></i> Document Viewer</span>
            <div class="container-fluid h-100">
                <div class="row mw-100 h-100">
                    <div class="col-md-6 p-2">
                        <div class="card mw-100 main_content">
                            <div class="card-body scrollable">
                                <form class="p-1">
                                    <div class="form-row">
                                        <div class="col-auto ml-md-auto">
                                            <label>Document Status:&nbsp;</label><span id="badgeCREATE" class="badge badge-warning" hidden>CREATED</span><span id="badgeRELEASE" class="badge badge-success" hidden>RELEASED</span>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-8">
                                            <div class="form-group">
                                                <label for="documentNo">Document Number</label>
                                                <input type="text" class="form-control" id="documentNo" placeholder="Document Number" readonly />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="documentPart">Part</label>
                                                <input type="text" class="form-control" id="documentPart" placeholder="Part" readonly />
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="documentVersion">Version</label>
                                                <input type="number" class="form-control" id="documentVersion" placeholder="Auto" value="00" readonly />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-6 mr-md-auto">
                                            <div class="form-group">
                                                <label for="labOffice">Lab Office</label>
                                                <select class="form-control" id="labOffice"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col mw-100">
                                            <div class="form-group">
                                                <label for="documentDesc">Description</label>
                                                <textarea class="form-control" id="documentDesc" rows="10"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col mw-100">
                                            <div class="form-group">
                                                <div>Originals:</div>
                                                <div class="table-responsive-sm" id="originalDocs">
                                                    <table id="attachmentTab" class="table table-striped table-hover">
                                                        <thead class="thead-light">
                                                            <tr>
                                                                <th width="5%">APPL.</th>
                                                                <th width="30%">Application</th>
                                                                <th width="*">File Name</th>
                                                                <th width="10%">Checked</th>
                                                                <th width="13%"></th>
                                                            </tr>
                                                        </thead>
                                                        <tbody></tbody>
                                                        <tfoot>
                                                            <tr>
                                                                <td colspan="5">
                                                                    <span class="btn btn-success fileinput-button">
                                                                        <i class="fas fa-plus-circle"></i> 
                                                                        <span>Check-in files...</span>
                                                                        <!-- The file input field used as target for the file upload widget -->
                                                                        <input id="fileupload" type="file" name="files[]" multiple>
                                                                    </span>
                                                                </td>                                                               
                                                            </tr>                                                           
                                                        </tfoot>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="card-footer">
                                <button type="button" id="docSave" class="btn btn-outline-primary"><i class="far fa-save"></i> <span id="docSave_lbl">Create</span></button>
                                <button type="button" id="docCancel" class="btn btn-outline-danger"><i class="fas fa-undo"></i> Cancel</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 ml-md-auto p-2">
                        <div class="card mw-100 main_content">
                            <div class="card-header bg-warning">Additional Data</div>
                            <div class="card-body scrollable">
                                <form>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Aircraft Model:</label></div>
                                        <div class="col-md-8 p-1"><select class="mw-100 w-100" id="acModel" multiple="multiple"> </select></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG Aircraft Effectivity:</label></div>
                                        <div class="col-md-8 p-1"><select class="mw-100 w-100" id="TG_ACEff" multiple="multiple"> </select></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Revision No.:</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_revno" placeholder="Revision No." /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Revision/Edition/Issue Date:</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_revdate" placeholder="Revision/Edition/Issue Date" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Revision Code of Original Task:</label></div>
                                        <!-- <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_revcode" placeholder="Revision Code" /></div> -->
                                        <div class="col-md-8 p-1">
                                            <select class="form-control" id="c_revcode"></select>
                                        </div>
                                    </div>
                                    <div id="acZoneArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>A/C Zone <i id="more_aczone" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_aczone" name="c_aczone" placeholder="Aircraft Zonal" /></div>
                                        </div>
                                    </div>
                                    <div id="mpSourceArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MP Task Source <i id="more_mpsource" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><select class="form-control" id="c_mpsource" name="c_mpsource"></select></div>
                                        </div>
                                    </div>
                                    <div id="mpSectionArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MP Task Section <i id="more_mpsection" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><select class="form-control" id="c_mpsection" name="c_mpsection"></select></div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Percentage of Sampling Inspect</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_percsampling" placeholder="Percentage of Sampling Inspect" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Work Type</label></div>
                                        <div class="col-md-8 p-1"><select class="form-control" id="c_worktype"></select></div>
                                    </div>
                                    <div id="inspTaskArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>Spec. Ident. Inspection Task <i id="more_insptask" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><select class="form-control" id="c_insptask" name="c_insptask"></select></div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Original MP Task Number</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mptasknumber" placeholder="Original MP Task Number" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG MP Task Number</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_tgtasknumber" placeholder="TG MP Task Number" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Beginning Effective Date</label></div>
                                        <div class="col-md-8 p-1"><input type="date" class="form-control" id="c_validfrom" data-date-format="YYYYMMDD" placeholder="Beginning Effective Date" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MP Task Status</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mptaskstatus" placeholder="MP Task Status" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MP Task MH</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mptaskmh" placeholder="MP Task MH" /></div>
                                    </div>
                                    <div id="accessPanelArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>Access Panel Information <i id="more_accesspanel" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_accesspanel" name="c_accesspanel" placeholder="Access Panel Information" /></div>
                                        </div>
                                    </div>
                                    <div id="mpdOffsetArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MPD/OEM Task Offset <i id="more_mpdoffset" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mpdoffset" name="c_mpdoffset" placeholder="MPD/OEM Task Offset" /></div>
                                        </div>
                                    </div>
                                    <div id="mpdLimitIntervalArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MPD/OEM Task Limit/Interval <i id="more_mpdinterval" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1 form-inline"><input type="number" class="form-control col-sm-8" id="c_mpdlimitinterval" name="c_mpdlimitinterval" placeholder="MPD/OEM Task Limit/Interval" /><select class="form-control col-sm-4" id="MPDInterval" name="MPDInterval"></select></div>
                                        </div>
                                    </div>
                                    <div id="mpdoffsetsampleArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MPD/OEM Task Offset Sample <i id="more_mpdoffsetsample" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mpdoffsetsample" name="cmpdoffsetsample" placeholder="MPD/OEM Task Offset Sample" /></div>
                                        </div>
                                    </div>
                                    <div id="mpdintervalsampleArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MPD/OEM Task Interval Sample <i id="more_mpdintervalsample" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mpdintervalsample" name="c_mpdintervalsample" placeholder="MPD/OEM Task Interval Sample" /></div>
                                        </div>
                                    </div>
                                    <div id="tgTaskOffsetArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>TG Task Offset <i id="more_tgtaskoffset" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_tgtaskoffset" name="c_tgtaskoffset" placeholder="TG Task Offset" /></div>
                                        </div>
                                    </div>
                                    <div id="tgTaskLimitArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>TG Task Limit/Interval <i id="more_tgtasklimit" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1 form-inline"><input type="number" class="form-control col-sm-8" id="c_tgtasklimit" name="c_tgtasklimit" placeholder="TG Task Limit/Interval" /><select class="form-control col-sm-4" id="TGInterval" name="TGInterval"></select></div>
                                        </div>
                                    </div>
                                    <div id="tgtaskoffsetsampleArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>TG Task Offset Sample <i id="more_tgtaskoffsetsample" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_tgtaskoffsetsample" name="ctgtaskoffsetsample" placeholder="TG Task Offset Sample" /></div>
                                        </div>
                                    </div>
                                    <div id="tgtasklimitsampleArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>TG Task Interval Sample <i id="more_tgtasklimitsample" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_tgtasklimitsample" name="ctgtasklimitsample" placeholder="TG Task Interval Sample" /></div>
                                        </div>
                                    </div>
                                    <div id="mpdengineeffArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MPD Engine Effectivity <i id="more_mpdengineeff" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mpdengineeff" name="c_mpdengineeff" placeholder="MPD Engine Effectivity" /></div>
                                        </div>
                                    </div>
                                    <div id="mpdaircrafteffArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MPD Aircraft Effectivity <i id="more_mpdaircrafteff" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mpdaircrafteff" name="c_mpdaircrafteff" placeholder="MPD Aircraft Effectivity" /></div>
                                        </div>
                                    </div>
                                    <div id="mpdReferenceArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>MPD Reference <i id="more_mpdreference" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_mpdreference" name="c_mpdreference" placeholder="MPD Reference" /></div>
                                        </div>
                                    </div>
                                    <div id="otherReferenceArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>Other Reference <i id="more_otherreference" class="fas fa-chevron-circle-down"></i> </label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_otherreference" name="c_otherreference" placeholder="Other References" /></div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Detectability Code</label></div>
                                        <div class="col-md-8 p-1"><select class="form-control" id="c_deteccode"></select></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Insp. Report Req.</label></div>
                                        <div class="col-md-8 p-1"><div class="form-check-inline"><input type="checkbox" class="form-check-input" id="c_inspreportreq" value="Y" /><label class="form-check-label" for=" c_inspreqporereq"> YES</label></div></div>
                                    </div>
                                    <div id="tgintervaloffsetnoteArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>TG Interval/Offset Note <i id="more_tgintervaloffsetnote" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_tgintervaloffsetnote" placeholder="TG Interval/Offset Note" name="c_tgintervaloffsetnote" /></div>
                                        </div>
                                    </div>
                                    <div id="tgdependingArea">
                                        <div class="form-row">
                                            <div class="col-md-4"><label>Depending <i id="more_tgdepending" class="fas fa-chevron-circle-down"></i></label></div>
                                            <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_tgdepending" placeholder="Depending" name="c_tgdepending" /></div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Reason of Add/Del./Rev.</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_reason" placeholder="Reason of Add/Del./Rev." /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Engineering Note</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" id="c_engineeringnote" placeholder="Engineering Note" /></div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <div class="modal fade" id="DocumentSelector" tabindex="-1" role="dialog" aria-labelledby="DocumentSelector" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="far fa-clone"></i>Select Document</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body p-0">
                    <div class="container-fluid">
                        <div class="row p-0">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="s_documentNumber">Document</label>
                                    <input type="text" class="form-control" id="s_documentNumber" placeholder="Doc. No." value="" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="s_documentPart">Part</label>
                                    <input type="text" class="form-control" id="s_documentPart" placeholder="Part" value="" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="s_documentVersion">Version</label>
                                    <input type="number" class="form-control" id="s_documentVersion" placeholder="Version" value="00" />
                                </div>
                            </div>
                            <div class="col-md-2" style="vertical-align:text-bottom;">
                                <button id="searchRefDoc" type="button" class="btn-sm btn-outline-secondary" style="vertical-align:text-bottom;margin-top: 30px;"><i class="fas fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="container-fluid col-md-12" id="resultDocs">
                        <div id="search_result" />
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-outline-primary" id="selectDocAction">Select</button>
                </div>
            </div>
        </div>
    </div>
</body>
<!-- Java Script Section -->
<script src="framework/jquery-3.3.1.min.js"></script>
<script src="framework/bootstrap4/js/popper.min.js"></script>
<script src="framework/bootstrap4/js/bootstrap.min.js"></script>
<script src="framework/bootstrap4/js/bootstrap-multiselect.js"></script>
<script src="framework/jqwidgets/jqxcore.js"></script>
<script src="framework/jqwidgets/jqxdata.js"></script>
<script src="framework/jqwidgets/jqxbuttons.js"></script>
<script src="framework/jqwidgets/jqxgrid.js"></script>
<script src="framework/jqwidgets/jqxmenu.js"></script>
<script src="framework/jqwidgets/jqxpanel.js"></script>
<script src="framework/jqwidgets/jqxgrid.filter.js"></script>
<script src="framework/jqwidgets/jqxgrid.sort.js"></script>
<script src="framework/jqwidgets/jqxgrid.pager.js"></script>
<script src="framework/jqwidgets/jqxgrid.selection.js"></script>
<script src="framework/jqwidgets/jqxscrollbar.js"></script>
<script src="framework/jqwidgets/jqxinput.js"></script>
<script src="framework/jqwidgets/globalization/globalize.js"></script>
<script src="framework/fileupload/js/vendor/jquery.ui.widget.js"></script>
<script src="framework/fileupload/js/jquery.iframe-transport.js"></script>
<script src="framework/fileupload/js/jquery.fileupload.js"></script>
<script src="Scripts/toastr.min.js"></script>
<script>
    var u_mode = "";
    var o_acModel = [];
    var acModel = [];

    var tgAcEff = []
    var o_tgAcEff = [];

    var o_aczone = [];
    var o_mpsource = [];
    var o_tasksection = [];
    var o_specident = [];
    var o_accesspanel = [];
    var o_mpdtaskoffset = [];
    var o_mpdtasklimitinterval = [];
    var o_mpdtaskoffsetsample = [];
    var o_mpdtaskintervalsample = [];
    var o_tgtaskoffset = [];
    var o_tgtaskinterval = []
    var o_tgtaskoffsetsample = [];
    var o_tgtaskintervalsample = [];
    var o_mpdaircrafteff = [];
    var o_mpdengineeff = [];
    var o_mpdreference = [];
    var o_otherreference = [];
    var o_tgintervaloffsetnote = [];
    var o_depending = [];

    var selected = [];
    var intervalUnits = [];
    var laboratories = [];
    var aircrafts = [];
    var revisionCodes = [];
    var workTypes = [];
    var mpSources = [];
    var taskSections = [];
    var inspectSpecials = [];
    var detectCodes = [];

    var attachmentList = [];

    function getUrlVars() {
        var vars = [], hash;
        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        for (var i = 0; i < hashes.length; i++) {
            hash = hashes[i].split('=');

            if ($.inArray(hash[0], vars) > -1) {
                vars[hash[0]] += "," + hash[1];
            }
            else {
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
        }
        return vars;
    }

    function getIntervalUnit() {
        $.ajax({
            type: 'POST',
            url: 'DocumentWS.asmx/GetIntervalUnit',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            success: function (response) {
                var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);
                $(jsonData).each(function (index, value) {
                    intervalUnits.push(value);
                });

                $('#MPDInterval').empty();
                $('#TGInterval').empty();

                $(intervalUnits).each(function (index, value) {
                    $('#MPDInterval').append("<option value='" + value + "'>" + value + "</option>");
                    $('#TGInterval').append("<option value='" + value + "'>" + value + "</option>");
                });
            }
        });
    }

    function getAircraftModel() {
        $.ajax({
            type: 'POST',
            url: 'DocumentWS.asmx/GetAircraftModel',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            success: function (response) {
                var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);
                $(jsonData).each(function (index, value) {
                    acModel.push(value);
                });
                renderAcModel();
            }
        });
    }

    function getLaboratories() {
        $.ajax({
            type: 'POST',
            url: 'DocumentWS.asmx/GetLaboratories',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            success: function (response) {
                var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);
                $(jsonData).each(function (index, value) {
                    laboratories.push(value);
                });

                $('#labOffice').empty();
                $(laboratories).each(function (index, item) {
                    $('#labOffice').append("<option value='" + item.labCode + "'>" + item.labText + "</option>");
                });
            }
        });
    }

    function renderAircraftEff() {
        $('#TG_ACEff').empty();
        $(selected).each(function (i, item) {
            $('#TG_ACEff').append("<optgroup label='" + item.value + "'>");
            for (var i = 0, len = aircrafts.length; i < len; i++) {
                if (aircrafts[i] && aircrafts[i].actype == item.value) {
                    $('#TG_ACEff').append("<option value='" + aircrafts[i].acreg + "'>" + aircrafts[i].displayAC + "</option>");
                }
            }
            $('#TG_ACEff').append("</optgroup>");
            $('#TG_ACEff').multiselect('destroy');
            $('#TG_ACEff').multiselect({
                nonSelectedText: 'Please select an aircraft',
                enableClickableOptGroups: true,
                enableCollapsibleOptGroups: true,
                enableFiltering: true,
                buttonWidth: '100%',
                onChange: function (element, checked) {
                    var tgAircrafts = $('#TG_ACEff option:selected');
                    tgAcEff = [];
                    $(tgAircrafts).each(function (index, sel_acreg) {
                        tgAcEff.push(sel_acreg.label);
                    });
                }
            });
        });
    }

    function renderAcModel() {
        $(acModel).each(function (item, value) {
            $('#acModel').append("<option value='" + value + "'>" + value + "</option>");
        });

        $('#acModel').multiselect({
            nonSelectedText: 'Please select aircraft model',
            onChange: function (element, checked) {
                var fleetModel = $('#acModel option:selected');
                selected = [];
                $(fleetModel).each(function (index, model) {
                    selected.push(model);
                });
                renderAircraftEff();
            },
            buttonWidth: '100%'
        });
    }

    function renderRevisionCode() {
        $(revisionCodes).each(function (item, value) {
            $('#c_revcode').append("<option value='" + value.revisionCode + "'>" + value.revisionText + "</option>");
        });
    }

    function renderMPSource() {
        $(mpSources).each(function (item, value) {
            $('#c_mpsource').append("<option value='" + value.sourceCode + "'>" + value.sourceText + "</option>");
        });
    }

    function renderTaskSection() {
        $(taskSections).each(function (item, value) {
            $('#c_mpsection').append("<option value='" + value.taskCode + "'>" + value.taskText + "</option>");
        });
    }

    function renderWorkType() {
        $(workTypes).each(function (item, value) {
            $('#c_worktype').append("<option value='" + value.workValue + "'>" + value.workText + "</option>");
        });
    }

    function renderInspectSpecial() {
        $(inspectSpecials).each(function (item, value) {
            $('#c_insptask').append("<option value='" + value.inspectValue + "'>" + value.inspectText + "</option>");
        });
    }

    function renderDetectCode() {
        $(detectCodes).each(function (item, value) {
            $('#c_deteccode').append("<option value='" + value.detectCode + "'>" + value.detectText + "</option>");
        });
    }

    function queryDMS() {
        var qryDocNo = $('#s_documentNumber').val();
        if (qryDocNo == undefined) {
            qryDocNo = '';
        }

        var qryDocPart = $('#s_documentPart').val();
        if (qryDocPart == undefined) {
            qryDocPart = '';
        }

        var qryDocVers = $('#s_documentVersion').val();
        if (qryDocVers == undefined) {
            qryDocVers = '';
        }

        var qryDocStat = '';
        var qryResponsible = '';
        var qryLabOffice = '';

        var columnRenderer = function (value) {
            return '<div style="text-align: center; margin-top: 5px;">' + value + '</div>';
        }

        var jsonReq = '{docType: ' + JSON.stringify('MRI') + ', docNo: ' + JSON.stringify(qryDocNo) + ', docPart: ' + JSON.stringify(qryDocPart) + ', docVer: ' + JSON.stringify(qryDocVers) + ', docStat: ' + JSON.stringify(qryDocStat) + ', userName: ' + JSON.stringify(qryResponsible) + ', labOffice: ' + JSON.stringify(qryLabOffice) + '}';

        $.ajax({
            type: 'POST',
            url: 'DocumentWS.asmx/searchDMS',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            data: jsonReq,
            success: function (response) {
                var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);
                var source = {
                    datatype: "json",
                    datafields: [
                        { name: 'docNo' },
                        { name: 'docType' },
                        { name: 'docPart' },
                        { name: 'docVersion' },
                        { name: 'description' },
                        { name: 'userName' },
                        { name: 'status' },
                        { name: 'labCode' },
                        { name: 'laboratory' }
                    ],
                    localdata: jsonData
                };

                var selectedrow = -1;
                var dataAdapter = new $.jqx.dataAdapter(source);
                $('#search_result').jqxGrid({
                    width: '100%',
                    height: '100%',
                    altrows: true,
                    source: dataAdapter,
                    sortable: true,
                    columns: [
                        { datafield: 'docNo', text: 'Document', width: '60% ', renderer: columnRenderer, cellsalign: 'left' },
                        { datafield: 'docPart', text: 'Part', width: '25%', renderer: columnRenderer, cellsalign: 'center' },
                        { datafield: 'docVersion', text: 'Version', width: '15%', renderer: columnRenderer, cellsalign: 'center' }
                    ]
                });
            }
        });
    }

    function dissectCharacteristics(charact) {
        var arr_acModel = [];
        o_acmodel = [];
        selected = [];
        $.each(charact.acModel, function (index, value) {
            arr_acModel.push(value);
            o_acmodel.push(value);
            selected.push({ 'value': value });
        });
        $("#acModel").multiselect("select", arr_acModel);

        renderAircraftEff();

        var arr_tgAcEff = [];
        o_tgAcEff = [];
        $.each(charact.tgAircraftEff, function (index, value) {
            var acValue = aircrafts.filter(function (item) {
                return item.displayAC == value;
            })[0].acreg;
            arr_tgAcEff.push(acValue);
        });

        if (arr_tgAcEff && arr_tgAcEff.indexOf('ALL') >= 0) {
            $("#TG_ACEff").multiselect("selectAll", false);
        }
        else {
            $("#TG_ACEff").multiselect("select", arr_tgAcEff);
        }
        var tgAircrafts = $('#TG_ACEff option:selected');
        tgAcEff = [];
        $(tgAircrafts).each(function (index, sel_acreg) {
            o_tgAcEff.push(sel_acreg.label);
            tgAcEff.push(sel_acreg.label);
        });
        $('#TG_ACEff').multiselect('refresh');

        $("#c_revno").val(charact.revNumber);
        $("#c_revdate").val(charact.revDate);
        var revCode = revisionCodes.filter(function (item) {
            return item.revisionText == charact.revCode;
        })[0].revisionCode;
        $("#c_revcode").val(revCode);

        o_aczone = [];
        $.each(charact.acZone, function (index, value) {
            o_aczone.push(value);
            if (index == 0) {
                $("[name=c_aczone]")[0].value = value;
            }
            else {
                $('#acZoneArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_aczone[]" placeholder="Aircraft Zonal" value="' + value + '" /></div></div>');
            }
        });

        o_tasksection = [];
        $.each(charact.taskSection, function (index, value) {
            if (index == 0) {
                var s_tasksection = taskSections.filter(function (item) {
                    return item.taskText == value;
                })[0].taskCode;
                $("#c_mpsection").val(s_tasksection);
                o_tasksection.push(s_tasksection);
            }
            else {
                var strHTML = ""
                strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><select class="form-control" name="c_mpsection[]">');
                $(taskSections).each(function (index, val) {
                    if (val.taskText == value) {
                        strHTML += ("<option value='" + val.taskCode + "' selected>" + val.taskText + "</option>");
                        o_tasksection.push(val.taskCode);
                    } else {
                        strHTML += ("<option value='" + val.taskCode + "'>" + val.taskText + "</option>");
                    }
                });
                strHTML += '</select></div ></div >';
                $('#mpSectionArea').append(strHTML);
            }
        });

        $("#c_percsampling").val(charact.samplingPercent);

        var s_worktype = workTypes.filter(function (item) {
            return item.workText == charact.workType;
        })[0].workValue;
        $("#c_worktype").val(s_worktype);

        o_specident = [];
        $.each(charact.inspectSpecial, function (index, value) {
            if (index == 0) {
                var s_inspectspecial = inspectSpecials.filter(function (item) {
                    return item.inspectText == value;
                })[0].inspectValue;
                $("#c_insptask").val(s_inspectspecial);
                o_specident.push(s_inspectspecial);
            }
            else {
                var strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><select class="form-control" name="c_insptask[]">');
                $(inspectSpecials).each(function (index, val) {
                    if (val.inspectText == value) {
                        strHTML += ("<option value='" + val.inspectValue + "' selected>" + val.inspectText + "</option>");
                        o_specident.push(val.inspectValue);
                    } else {
                        strHTML += ("<option value='" + val.inspectValue + "'>" + val.inspectText + "</option>");
                    }
                });
                strHTML += '</select></div ></div >';
                $('#inspTaskArea').append(strHTML);
            }
        });

        o_mpsource = [];
        $.each(charact.mpSource, function (index, value) {
            if (index == 0) {
                var v_mpSource = mpSources.filter(function (item) {
                    return item.sourceText == value;
                })[0].sourceCode;
                $("[name=c_mpsource")[0].value = v_mpSource;
                o_mpsource.push(v_mpSource);
            }
            else {
                var strHTML = ""
                strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><select class="form-control" name="c_mpsource[]">');
                $(mpSources).each(function (index, val) {
                    if (val.sourceText == value) {
                        strHTML += ("<option value='" + val.sourceCode + "' selected>" + val.sourceText + "</option>");
                        o_mpsource.push(val.sourceCode);
                    } else {
                        strHTML += ("<option value='" + val.sourceCode + "'>" + val.sourceText + "</option>");
                    }
                });
                strHTML += '</select></div ></div >';
                $('#mpSourceArea').append(strHTML);
            }
        });

        $("#c_mptasknumber").val(charact.mpTaskNumber);
        $("#c_tgtasknumber").val(charact.tgTaskNumber);
        var s_date = charact.validFrom;
        var begDate = moment(s_date, "DD.MM.YYYY").format('YYYY-MM-DD');

        $("#c_validfrom").val(begDate);
        $("#c_mptaskstatus").val(charact.mpTaskStatus);
        $("#c_mptaskmh").val(charact.mpTaskMH);

        o_accesspanel = [];
        $.each(charact.accessPanel, function (index, value) {
            o_accesspanel.push(value);
            if (index == 0) {
                $("[name=c_accesspanel]")[0].value = value;
            }
            else {
                $('#accessPanelArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_accesspanel[]" placeholder="Access Panel Information" value="' + value + '" /></div></div>');
            }
        });

        o_mpdtaskoffset = [];
        $.each(charact.mpdOffset, function (index, value) {
            o_mpdtaskoffset.push(value);
            if (index == 0) {
                $("[name=c_mpdoffset]")[0].value = value;
            }
            else {
                $('#mpdOffsetArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdoffset[]" placeholder="MPD/OEM Task Offset" value="' + value + '" /></div></div>');
            }
        });

        o_mpdtasklimitinterval = [];
        $.each(charact.mpdLimitInterval, function (index, value) {
            o_mpdtasklimitinterval.push(value);
            if (index == 0) {
                var valToken = value.split(" ");
                $("[name=c_mpdlimitinterval]")[0].value = valToken[0];
                $("[name=MPDInterval]")[0].value = valToken[1];
            }
            else {
                var valToken = value.split(" ");
                var strHTML = ""
                strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1 form-inline"><input type="number" class="form-control col-sm-8" name="c_mpdlimitinterval[]" placeholder="MPD / OEM Task Limit / Interval" value="' + valToken[0] + '" /><select class="form-control col-sm-4" name="MPDInterval[]">');
                $(intervalUnits).each(function (index, val) {
                    if (val == valToken[1]) {
                        strHTML += ("<option value='" + val + "' selected>" + val + "</option>");
                    } else {
                        strHTML += ("<option value='" + val + "'>" + val + "</option>");
                    }
                });
                strHTML += '</select></div ></div >'
                $('#mpdLimitIntervalArea').append(strHTML);
            }
        });

        o_mpdtaskoffsetsample = [];
        $.each(charact.mpdOffsetSample, function (index, value) {
            o_mpdtaskoffsetsample.push(value);
            if (index == 0) {
                $("[name=cmpdoffsetsample]")[0].value = value;
            }
            else {
                $('#mpdoffsetsampleArea').append('<div class= "form-row" ><div class="col-md-4">&nbsp;</div> <div class="col-md-8 p-1"><input type="text" class="form-control"  name="cmpdoffsetsample[]" placeholder="MPD/OEM Task Offset Sample" value="' + value + '" /></div></div>');
            }
        });

        o_mpdtaskintervalsample = [];
        $.each(charact.mpdIntervalSample, function (index, value) {
            o_mpdtaskintervalsample.push(value);
            if (index == 0) {
                $("[name=c_mpdintervalsample]")[0].value = value;
            }
            else {
                $('#mpdintervalsampleArea').append('<div class= "form-row" > <div class="col-md-4">&nbsp;</div> <div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdintervalsample[]" placeholder="MPD/OEM Task Interval Sample" value="' + value + '" /></div></div>');
            }
        });

        o_tgtaskoffset = [];
        $.each(charact.tgTaskOffset, function (index, value) {
            o_tgtaskoffset.push(value);
            if (index == 0) {
                $("[name=c_tgtaskoffset]")[0].value = value;
            }
            else {
                $('#tgTaskOffsetArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_tgtaskoffset[]" placeholder="TG Task Offset" value="' + value + '" /></div></div>');
            }
        });

        o_tgtaskinterval = [];
        $.each(charact.tgTaskLimit, function (index, value) {
            o_tgtaskinterval.push(value);
            if (index == 0) {
                var valToken = value.split(" ");
                $("[name=c_tgtasklimit]")[0].value = valToken[0];
                $("[name=TGInterval]")[0].value = valToken[1];
            }
            else {
                var valToken = value.split(" ");
                var strHTML = ""
                strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1 form-inline"><input type="number" class="form-control col-sm-8" name="c_tgtasklimit[]" placeholder="TG Task Task Limit/Interval" value="' + valToken[0] + '" /><select class="form-control col-sm-4" name="TGInterval[]">');
                $(intervalUnits).each(function (index, val) {
                    if (val == valToken[1]) {
                        strHTML += ("<option value='" + val + "' selected>" + val + "</option>");
                    } else {
                        strHTML += ("<option value='" + val + "'>" + val + "</option>");
                    }
                });
                strHTML += '</select></div ></div >'
                $('#tgTaskLimitArea').append(strHTML);
            }
        });

        o_tgtaskoffsetsample = [];
        $.each(charact.tgTaskOffsetSample, function (index, value) {
            o_tgtaskoffsetsample.push(value);
            if (index == 0) {
                $("[name=ctgtaskoffsetsample")[0].value = value;
            }
            else {
                $('#tgtaskoffsetsampleArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="ctgtaskoffsetsample[]" placeholder="TG Task Offset Sample" value="' + value + '" /></div></div>');
            }
        });

        o_tgtaskintervalsample = [];
        $.each(charact.tgTaskLimitSample, function (index, value) {
            o_tgtaskintervalsample.push(value);
            if (index == 0) {
                $("[name=ctgtasklimitsample")[0].value = value;
            }
            else {
                $('#tgtasklimitsampleArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="ctgtasklimitsample[]" placeholder="TG Task Interval Sample" value="' + value + '" /></div></div>');
            }
        });

        o_mpdengineeff = [];
        $.each(charact.mpdEngineEff, function (index, value) {
            o_mpdengineeff.push(value);
            if (index == 0) {
                $("[name=c_mpdengineeff")[0].value = value;
            }
            else {
                $('#mpdengineeffArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdengineeff[]" placeholder="MPD Engine Effectivity" value="' + value + '" /></div></div>');
            }
        });

        o_mpdaircrafteff = [];
        $.each(charact.mpdAircraftEff, function (index, value) {
            o_mpdaircrafteff.push(value);
            if (index == 0) {
                $("[name=c_mpdaircrafteff")[0].value = value;
            }
            else {
                $('#mpdaircrafteffArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdaircrafteff[]" placeholder="MPD Aircraft Effectivity" value="' + value + '" /></div></div>');
            }
        });

        o_mpdreference = [];
        $.each(charact.mpdReference, function (index, value) {
            o_mpdreference.push(value);
            if (index == 0) {
                $("[name=c_mpdreference]")[0].value = value;
            }
            else {
                $('#mpdReferenceArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdreference[]" placeholder="MPD Reference" value="' + value + '" /></div></div>');
            }
        });

        o_otherreference = [];
        $.each(charact.otherReference, function (index, value) {
            o_otherreference.push(value);
            if (index == 0) {
                $("[name=c_otherreference]")[0].value = value;
            }
            else {
                $('#otherReferenceArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_otherreference[]" placeholder="Other References" value="' + value + '" /></div></div>');
            }
        });

        var v_detecCode = detectCodes.filter(function (item) {
            return item.detectText == charact.detecCode;
        })[0].detectCode;
        $("#c_deteccode").val(v_detecCode);

        if (charact.inspReportReq != undefined && charact.inspReportReq == "Yes") {
            $("#c_inspreportreq").prop('checked', true);
        }
        else {
            $("#c_inspreportreq").prop('checked', false);
        }

        o_tgintervaloffsetnote = [];
        $.each(charact.tgIntervalOffsetNote, function (index, value) {
            o_tgintervaloffsetnote.push(value);
            if (index == 0) {
                $("[name=c_tgintervaloffsetnote]")[0].value = value;
            }
            else {
                $("#tgintervaloffsetnoteArea").append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_tgintervaloffsetnote[]" placeholder="TG Interval/Offset Note" value="' + value + '" /></div></div>');
            }
        });

        o_depending = [];
        $.each(charact.tgDepending, function (index, value) {
            o_depending.push(value);
            if (index == 0) {
                $("[name=c_tgdepending]")[0].value = value;
            }
            else {
                $('#tgdependingArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_tgdepending[]" placeholder="Depending" value="' + value + '" /></div></div>');
            }
        });

        $("#c_reason").val(charact.reason);
        $("#c_engineeringnote").val(charact.engineeringNote);
    }

    function showContent(fileID) {
        window.open("DisplayDocContent.ashx?FILEID=" + fileID, "_blank");        
    }

    function showAttachments(docNo, docPart, docVersion, attachments) {
        
        $.each(attachments, function (index, attachment) {
            var htmlRow = "<tr>";
            var appIcon;
            var application;

            attachmentList.push({"application" : attachment.application, "origFile": attachment.origFile, "docFile": attachment.docFile, "applicationID": attachment.applicationID, "fileID": attachment.fileID, "checkedIN": attachment.checkedIN, "updateStatus": 'C'});

            switch (attachment.application) {
                case 'PDF': appIcon = "far fa-file-pdf "; application = "Acrobat Reader"; break;
                case 'DOC': appIcon = "far fa-file-word "; application = "MS WinWord"; break;
                case 'WWI': appIcon = "far fa-file-word "; application = "MS WinWord"; break;
                case 'MPP': appIcon = "far fa-file-invoice "; application = "MS Project"; break;
                case 'XLS': appIcon = "far fa-file-excel "; application = "MS Excel"; break;
                case 'XLSX': appIcon = "far fa-file-excel "; application = "MS Excel"; break;
                case 'TXT': appIcon = "far fa-file-alt "; application = "Text File"; break;
                case 'PPT': appIcon = "far fa-file-powerpoint "; application = "MS Powerpoint"; break;
                case 'JPG': appIcon = "far fa-file-image "; application = "JPEG Image"; break;
                case 'PNG': appIcon = "far fa-file-image "; application = "GIF Image"; break;
                case 'GRF': appIcon = "far fa-file-image "; application = "Graphic File"; break;
                case 'SND': appIcon = "far fa-file-audio "; application = "Sound File"; break;
                case 'ACD': appIcon = "far fa-file-contract "; application = "Autocad"; break;
                case 'ZIP': appIcon = "far fa-file-archive "; application = "Compressed DocCreate J/C files"; break;
                default: appIcon = "far fa-file "; application = "N/A"; break;
            }
            var lockIcon;
            if (attachment.checkedIN != undefined && attachment.checkedIN == 'X') {
                lockIcon = "fas fa-lock ";
            }
            else {
                lockIcon = "fas fa-lock-open ";
            }
            htmlRow += "<td align='center'><i class='" + appIcon + " fa-2x'></i></td><td align='left'>" + application + "</td><td>" + attachment.docFile + "</td><td align='center'><i class='" + lockIcon + " fa-2x'></i></td><td align='center'><button type='button' onClick='showContent(\"" + attachment.fileID + "\");' class='btn-sm btn-light'><i class='fas fa-glasses'></i></button><button type='button' class='btn-sm btn-danger'><i class='fas fa-trash-alt'></i></button></td>";
            htmlRow += "</tr>";
            $('#attachmentTab tbody').append(htmlRow);
        });
    }

    function getDocumentDetail(docNo, docPart, docVersion) {
        var jsonReq = '{docNo: ' + JSON.stringify(docNo) + ', docPart: ' + JSON.stringify(docPart) + ', docVersion: ' + JSON.stringify(docVersion) + '}';

        $.ajax({
            type: 'POST',
            url: 'DocumentWS.asmx/getDocDetails',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            data: jsonReq,
            success: function (response) {
                var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);
                $('#documentDesc').val(jsonData.description);
                $('#labOffice').val(jsonData.labCode);
                var statusText = jsonData.status;
                switch (statusText) {
                    case 'CR': $('#badgeCREATE').removeAttr('hidden'); $('#badgeRELEASE').hide(); break;
                    case 'RE': $('#badgeCREATE').hide(); $('#badgeRELEASE').removeAttr('hidden'); break;
                    default: $('#badgeCREATE').removeAttr('hidden'); $('#badgeRELEASE').hide(); break;
                }
                dissectCharacteristics(jsonData.characteristics);

                if (u_mode != undefined && u_mode != "" && u_mode == "CHANGE") {
                    showAttachments(docNo, docPart, docVersion, jsonData.attachments);
                }
            }
        });
    }

    function getSelectedRow() {
        var rowIndex = $('#search_result').jqxGrid('getselectedrowindexes');
        if (rowIndex == undefined || rowIndex.length == 0) {
            alert('Please select a row from the list!!!');
            return;
        }
        else {
            var selectedRowData = $('#search_result').jqxGrid('getrowdata', rowIndex[0]);
            $('#documentNo').val(selectedRowData.docNo);
            $('#documentPart').val(selectedRowData.docPart);
            $('#documentVersion').val(selectedRowData.docVersion);
            $('#DocumentSelector').modal('hide');
            getDocumentDetail(selectedRowData.docNo, selectedRowData.docPart, selectedRowData.docVersion);
        }
    }

    function getURLsDoc(operation, docNo, docPart, docVersion) {
        $('#documentNo').val(docNo);
        $('#documentPart').val(docPart);
        if (operation != undefined && operation == 'CHANGE') {
            $('#docSave_lbl').text('Save');
            $('#documentVersion').val(docVersion);
        }
        else {
            $('#docSave_lbl').text('Create');
            $('#documentVersion').val("");
        }
        getDocumentDetail(docNo, docPart, docVersion);
    }

    function getTemplateDoc(operation, docNo, docPart, docVersion, ref_docNo, ref_docPart, ref_docVersion) {
        $('#documentNo').val(docNo);
        $('#documentPart').val(docPart);


        if (operation != undefined && operation == 'CHANGE') {
            $('#docSave_lbl').text('Save');
            $('#documentVersion').val(docVersion);
        }
        else {
            $('#docSave_lbl').text('Create');
            $('#documentVersion').val("");
        }
        getDocumentDetail(ref_docNo, ref_docPart, ref_docVersion);
    }

    var v_docHeader = {};
    var v_mriClass = {};
    var userName = 'TG27394';

    function getDocumentHeader() {
        var docNumber = $('#documentNo').val();
        var docType = 'MRI';
        var docPart = $('#documentPart').val();
        var docVersion = $('#documentVersion').val();
        var labOffice = $('#labOffice').val();
        var docDesc = $('#documentDesc').val();

        v_docHeader = { 'docNo': docNumber, 'docType': docType, 'docPart': docPart, 'docVersion': docVersion, 'description': docDesc, 'laboratory': labOffice, 'userName': userName, 'attachments': attachmentList };
    }

    function getMRIClassData() {
        var aircraftModel = [];
        $(selected).each(function (index, item) {
            aircraftModel.push(item.value);
        });

        var revNumber = $('#c_revno').val();
        var revDate = $('#c_revdate').val();
        var revCode = $('#c_revcode').val();


        var acZone = [];
        $('input[name ^= "c_aczone"]').each(function () {
            acZone.push($(this).val());
        });

        $.each(o_aczone, function (index, value) {
            var idx = $.inArray(value, acZone);
            if (idx < 0) {
                acZone.push("X-DELETED-X" + value);
            }
        });

        var mpSource = [];
        $('select[name ^= "c_mpsource"]').each(function () {
            mpSource.push($(this).val());
        });
        $.each(o_mpsource, function (index, value) {
            var idx = $.inArray(value, mpSource);
            if (idx < 0) {
                mpSource.push("X-DELETED-X" + value);
            }
        });

        var taskSelection = [];
        $('select[name ^= "c_mpsection"]').each(function () {
            taskSelection.push($(this).val());
        });
        $.each(o_tasksection, function (index, value) {
            var idx = $.inArray(value, taskSelection);
            if (idx < 0) {
                taskSelection.push("X-DELETED-X" + value);
            }
        });

        var samplingPercent = $('#c_persampling').val();
        var workType = $('#c_worktype').val();

        var inspectSpecial = [];
        $('select[name ^= "c_insptask"]').each(function () {
            inspectSpecial.push($(this).val());
        });
        $.each(o_specident, function (index, value) {
            var idx = $.inArray(value, inspectSpecial);
            if (idx < 0) {
                inspectSpecial.push("X-DELETED-X" + value);
            }
        });

        var mpTaskNumber = $('c_mptasknumber').val();
        var tgTaskNumber = $('#c_tgtasknumber').val();
        var validFrom = $('#c_validfrom').val();
        var mpTaskStatus = $('#c_mptaskstatus').val();
        var mpTaskMH = $('#c_mptaskmh').val();

        var accessPanel = [];
        $('input[name ^= "c_accesspanel"]').each(function () {
            accessPanel.push($(this).val());
        });
        $.each(o_accesspanel, function (index, value) {
            var idx = $.inArray(value, accessPanel);
            if (idx < 0) {
                accessPanel.push("X-DELETED-X" + value);
            }
        });

        var mpdOffset = [];
        $('input[name ^= "c_mpdoffset"]').each(function () {
            mpdOffset.push($(this).val());
        });
        $.each(o_mpdtaskoffset, function (index, value) {
            var idx = $.inArray(value, mpdOffset);
            if (idx < 0) {
                mpdOffset.push("X-DELETED-X" + value);
            }
        });

        var arr_mpdlimitinterval = [];
        var arr_mpdinterval = [];

        $('input[name ^= "c_mpdlimitinterval"]').each(function () {
            arr_mpdlimitinterval.push($(this).val());
        });

        $('select[name ^= "MPDInterval"]').each(function () {
            arr_mpdinterval.push($(this).val());
        });

        var mpdLimitInterval = [];
        $.each(arr_mpdlimitinterval, function (index, value) {
            if (arr_mpdlimitinterval[index] != undefined && arr_mpdlimitinterval[index] != "") {
                mpdLimitInterval.push(arr_mpdlimitinterval[index] + " " + arr_mpdinterval[index]);
            }
        });

        $.each(o_mpdtasklimitinterval, function (index, value) {
            var idx = $.inArray(value, mpdLimitInterval);
            if (idx < 0) {
                mpdLimitInterval.push("X-DELETED-X" + value);
            }
        });

        var mpdOffsetSample = [];
        $('input[name ^= "cmpdoffsetsample"]').each(function () {
            mpdOffsetSample.push($(this).val());
        });
        $.each(o_mpdtaskoffsetsample, function (index, value) {
            var idx = $.inArray(value, mpdOffsetSample);
            if (idx < 0) {
                mpdOffsetSample.push("X-DELETED-X" + value);
            }
        })

        var mpdIntervalSample = [];
        $('input[name ^= "c_mpdintervalsample"]').each(function () {
            mpdIntervalSample.push($(this).val());
        });
        $.each(o_mpdtaskintervalsample, function (index, value) {
            var idx = $.inArray(value, mpdIntervalSample);
            if (idx < 0) {
                mpdIntervalSample.push("X-DELETED-X" + value);
            }
        });

        var tgTaskOffset = [];
        $('input[name ^= "c_tgtaskoffset"]').each(function () {
            tgTaskOffset.push($(this).val());
        });
        $.each(o_tgtaskoffset, function (index, value) {
            var idx = $.inArray(value, tgTaskOffset);
            if (idx < 0) {
                tgTaskOffset.push("X-DELETED-X" + value);
            }
        });

        var arr_tglimitinterval = [];
        var arr_tginterval = [];

        $('input[name ^= "c_tgtasklimit"]').each(function () {
            arr_tglimitinterval.push($(this).val());
        });

        $('select[name ^= "TGInterval"]').each(function () {
            arr_tginterval.push($(this).val());
        });

        var tgTaskLimit = [];
        $.each(arr_tglimitinterval, function (index, value) {
            if (arr_tglimitinterval[index] != undefined && arr_tglimitinterval[index] != "") {
                tgTaskLimit.push(arr_tglimitinterval[index] + " " + arr_tginterval[index]);
            }
        });

        $.each(o_tgtaskinterval, function (index, value) {
            var idx = $.inArray(value, tgTaskLimit);
            if (idx < 0) {
                tgTaskLimit.push("X-DELETED-X" + value);
            }
        });

        var tgTaskOffsetSample = [];
        $('input[name ^= "ctgtaskoffsetsample"]').each(function () {
            tgTaskOffsetSample.push($(this).val());
        });
        $.each(o_tgtaskoffsetsample, function (index, value) {
            var idx = $.inArray(value, tgTaskOffsetSample);
            if (idx < 0) {
                tgTaskOffsetSample.push("X-DELETED-X" + value);
            }
        });

        var tgTaskLimitSample = [];
        $('input[name ^= "ctgtasklimitsample"]').each(function () {
            tgTaskLimitSample.push($(this).val());
        });
        $.each(o_tgtaskintervalsample, function (index, value) {
            var idx = $.inArray(value, tgTaskLimitSample);
            if (idx < 0) {
                tgTaskLimitSample.push("X-DELETED-X" + value);
            }
        });

        var mpdEngineEff = [];
        $('input[name ^= "c_mpdengineeff"]').each(function () {
            mpdEngineEff.push($(this).val());
        });
        $.each(o_mpdengineeff, function (index, value) {
            var idx = $.inArray(value, mpdEngineEff);
            if (idx < 0) {
                mpdEngineEff.push("X-DELETED-X" + value);
            }
        });

        var mpdAircraftEff = [];
        $('input[name ^= "c_mpdaircrafteff"]').each(function () {
            mpdAircraftEff.push($(this).val());
        });
        $.each(o_mpdaircrafteff, function (index, value) {
            var idx = $.inArray(value, mpdAircraftEff);
            if (idx < 0) {
                mpdAircraftEff.push("X-DELETED-X" + value);
            }
        });

        var tgAircraftEff = [];
        $(tgAcEff).each(function (index, item) {
            tgAircraftEff.push(item);
        });
        $.each(o_tgAcEff, function (index, value) {
            var idx = $.inArray(value, tgAircraftEff);
            if (idx < 0) {
                tgAircraftEff("X-DELETED-X" + value);
            }
        });

        var mpdReference = [];
        $('input[name ^= "c_mpdreference"]').each(function () {
            mpdReference.push($(this).val());
        });
        $.each(o_mpdreference, function (index, value) {
            var idx = $.inArray(value, mpdReference);
            if (idx < 0) {
                mpdReference.push("X-DELETED-X" + value);
            }
        });

        var otherReference = [];
        $('input[name ^= "c_otherreference"]').each(function () {
            otherReference.push($(this).val());
        });
        $.each(o_otherreference, function (index, value) {
            var idx = $.inArray(value, otherReference);
            if (idx < 0) {
                otherReference.push("X-DELETED-X" + value);
            }
        });

        var detecCode = $('#c_deteccode').val();

        var v_inspreq = "";
        if ($('#c_inspreportreq').prop('checked') == true) {
            v_inspreq = "Y";
        }
        var inspReportReq = v_inspreq;

        var tgIntervalOffsetNote = [];
        $('input[name ^= "c_tgintervaloffsetnote"]').each(function () {
            tgIntervalOffsetNote.push(($(this).val()));
        });
        $.each(o_tgintervaloffsetnote, function (index, value) {
            var idx = $.inArray(value, tgIntervalOffsetNote);
            if (idx < 0) {
                tgIntervalOffsetNote.push("X-DELETED-X" + value);
            }
        });

        var tgDepending = [];
        $('input[name ^= "c_tgdepending"]').each(function () {
            tgDepending.push(($(this).val()));
        });
        $.each(o_depending, function (index, value) {
            var idx = $.inArray(value, tgDepending);
            if (idx < 0) {
                tgDepending.push("X-DELETED-X" + value);
            }
        });

        var reason = $('#c_reason').val();
        var engineeringNote = $('#c_engineeringnote').val();

        v_mriClass = { 'acModel': aircraftModel, 'revNumber': revNumber, 'revDate': revDate, 'revCode': revCode, 'acZone': acZone, 'mpSource': mpSource, 'taskSection': taskSelection, 'samplingPercent': samplingPercent, 'workType': workType, 'inspectSpecial': inspectSpecial, 'mpTaskNumber': mpTaskNumber, 'tgTaskNumber': tgTaskNumber, 'validFrom': validFrom, 'mpTaskStatus': mpTaskStatus, 'mpTaskMH': mpTaskMH, 'accessPanel': accessPanel, 'mpdOffset': mpdOffset, 'mpdLimitInterval': mpdLimitInterval, 'mpdOffsetSample': mpdOffsetSample, 'mpdIntervalSample': mpdIntervalSample, 'tgTaskOffset': tgTaskOffset, 'tgTaskLimit': tgTaskLimit, 'tgTaskOffsetSample': tgTaskOffsetSample, 'tgTaskLimitSample': tgTaskLimitSample, 'mpdEngineEff': mpdEngineEff, 'mpdAircraftEff': mpdAircraftEff, 'tgAircraftEff': tgAircraftEff, 'mpdReference': mpdReference, 'otherReference': otherReference, 'detecCode': detecCode, 'inspReportReq': inspReportReq, 'tgIntervalOffsetNote': tgIntervalOffsetNote, 'tgDepending': tgDepending, 'reason': reason, 'engineeringNote': engineeringNote };
    }

    $(document).ready(function () {
        getLaboratories();
        getIntervalUnit();
        getAircraftModel();

        aircrafts = JSON.parse(localStorage.getItem("ACFLEET"));
        revisionCodes = JSON.parse(localStorage.getItem("REVISIONCODE")); renderRevisionCode();
        workTypes = JSON.parse(localStorage.getItem("WORKTYPE")); renderWorkType();
        inspectSpecials = JSON.parse(localStorage.getItem("INSPECTSPECIAL")); renderInspectSpecial();
        mpSources = JSON.parse(localStorage.getItem("MPSOURCE")); renderMPSource();
        taskSections = JSON.parse(localStorage.getItem("TASKSECTION")); renderTaskSection();
        detectCodes = JSON.parse(localStorage.getItem("DETECTCODE")); renderDetectCode();

        $('[data-toggle="tooltip"]').tooltip();

        $('#TG_ACEff').multiselect({
            nonSelectedText: 'Please select an aircraft',
            enableClickableOptGroups: true,
            enableCollapsibleOptGroups: true,
            enableFiltering: true,
            buttonWidth: '100%'
        });

        $("#s_documentNumber").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#selectDocuments option").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });

        $("#s_documentPart").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#selectDocuments option").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });

        $('#searchRefDoc').click(function () {
            queryDMS();
        });

        $('#selectDocAction').click(function () {
            getSelectedRow();
        });

        u_mode = decodeURIComponent(getUrlVars()["MODE"]);
        var u_docNo = decodeURIComponent(getUrlVars()["DOCUMENTNUMBER"]);
        var u_docPart = decodeURIComponent(getUrlVars()["DOCUMENTPART"]);
        var u_docVersion = decodeURIComponent(getUrlVars()["DOCUMENTVERSION"]);

        var t_docNo = decodeURIComponent(getUrlVars()["REFDOCUMENTNUMBER"]);
        var t_docPart = decodeURIComponent(getUrlVars()["REFDOCUMENTPART"]);
        var t_docVersion = decodeURIComponent(getUrlVars()["REFDOCUMENTVERSION"]);

        if (u_docNo != 'undefined' && u_docNo != '') {
            if (u_mode != undefined && u_mode == "TEMPLATE") {
                getTemplateDoc(u_mode, u_docNo, u_docPart, u_docVersion, t_docNo, t_docPart, t_docVersion);
            }
            else {
                getURLsDoc(u_mode, u_docNo, u_docPart, u_docVersion);
            }
        }
        else {
            $('#DocumentSelector').modal('show');
        }
    });

    $('#docSave').click(function () {
        v_docHeader = {};
        v_mriClass = {};
        getDocumentHeader();
        getMRIClassData();
        var postObj = {
            doc: v_docHeader,
            mriClass: v_mriClass
        };

        var operationMode = $('#docSave_lbl').text();
        if (operationMode == 'Save') {
            $.ajax({
                type: 'POST',
                url: 'DocumentWS.asmx/saveMRIDoc',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: JSON.stringify(postObj),
                success: function (response) {
                    var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);

                    if (jsonData.result)
                        toastr["success"](jsonData.message);
                    else
                        toastr["error"](jsonData.message);
                },
                error: function (response) {
                    toastr["error"]("Error while saving document data to SAP system!!!");
                }
            });
        }
        else {
            $.ajax({
                type: 'POST',
                url: 'DocumentWS.asmx/createMRIDoc',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: JSON.stringify(postObj),
                success: function (response) {
                    var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);

                    if (jsonData.result)
                        toastr["success"](jsonData.message);
                    else
                        toastr["error"](jsonData.message);
                },
                error: function (response) {
                    toastr["error"]("Error while saving document data to SAP system!!!");
                }
            });
        }
    });

    $('#more_aczone').click(function (e) {
        lastValue = $('#acZoneArea input:last').val();

        if (lastValue != undefined && lastValue != "") {
            $('#acZoneArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_aczone[]" placeholder="Aircraft Zonal" value="" /></div></div>');
        }
        $('#acZoneArea input:last').focus();
    });

    $('#more_accesspanel').click(function (e) {
        lastValue = $('#accessPanelArea input:last').val();

        if (lastValue != undefined && lastValue != "") {
            $('#accessPanelArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_accesspanel[]" placeholder="Access Panel Information" value="" /></div></div>');
        }
        $('#accessPanelArea input:last').focus();
    });

    $('#more_mpsource').click(function (e) {
        lastValue = $('#mpSourceArea select:last').val();
        if (lastValue != undefined && lastValue != "") {
            var strHTML = ""
            strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><select class="form-control" name="c_mpsource[]">');
            $(mpSources).each(function (index, val) {
                if (val == '') {
                    strHTML += ("<option value='" + val.sourceCode + "' selected>" + val.sourceText + "</option>");
                } else {
                    strHTML += ("<option value='" + val.sourceCode + "'>" + val.sourceText + "</option>");
                }
            });
            strHTML += '</select></div ></div >';
            $('#mpSourceArea').append(strHTML);
        }
        $('#mpSourceArea select:last').focus();
    });

    $('#more_mpdoffset').click(function (e) {
        lastValue = $('#mpdOffsetArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#mpdOffsetArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdoffset[]" placeholder="MPD/OEM Task Offset" value="" /></div></div>');
        }
        $('#mpdOffsetArea input:last').focus();
    });

    $('#more_mpdinterval').click(function (e) {
        lastValue = $('#mpdLimitIntervalArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            var strHTML = ""
            strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1 form-inline"><input type="number" class="form-control col-sm-8" name="c_mpdlimitinterval[]" placeholder="MPD / OEM Task Limit / Interval" value="" /><select class="form-control col-sm-4" name="MPDInterval[]">');
            $(intervalUnits).each(function (index, val) {
                strHTML += ("<option value='" + val + "'>" + val + "</option>");
            });
            strHTML += '</select></div ></div >'
            $('#mpdLimitIntervalArea').append(strHTML);
        }
        $('#mpdLimitIntervalArea input:last').focus();
    });

    $('#more_tgtaskoffset').click(function (e) {
        lastValue = $('#tgTaskOffsetArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#tgTaskOffsetArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_tgtaskoffset[]" placeholder="TG Task Offset" value="" /></div></div>');
        }
        $('#tgTaskOffsetArea input:last').focus();
    });

    $('#more_tgtasklimit').click(function (e) {
        lastValue = $('#tgTaskLimitArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            var strHTML = ""
            strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1 form-inline"><input type="number" class="form-control col-sm-8" name="c_tgtasklimit[]" placeholder=""TG Task Interval Sample" value="" /><select class="form-control col-sm-4" name="TGInterval[]">');
            $(intervalUnits).each(function (index, val) {
                strHTML += ("<option value='" + val + "'>" + val + "</option>");
            });
            strHTML += '</select></div ></div >'
            $('#tgTaskLimitArea').append(strHTML);
        }
        $('#tgTaskLimitArea input:last').focus();
    });

    $('#more_mpdreference').click(function (e) {
        lastValue = $('#mpdReferenceArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#mpdReferenceArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdreference[]" placeholder="MPD References" value="" /></div></div>');
        }
        $('#mpdReferenceArea input:last').focus();
    });

    $('#more_otherreference').click(function (e) {
        lastValue = $('#otherReferenceArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#otherReferenceArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_otherreference[]" placeholder="Other References" value="" /></div></div>');
        }
        $('#otherReferenceArea input:last').focus();
    });

    $('#more_mpsection').click(function (e) {
        lastValue = $('#mpSectionArea select:last').val();
        if (lastValue != undefined && lastValue != "") {
            var strHTML = ""
            strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><select class="form-control" name="c_mpsection[]">');
            $(taskSections).each(function (index, val) {
                if (val == '') {
                    strHTML += ("<option value='" + val.taskCode + "' selected>" + val.taskText + "</option>");
                } else {
                    strHTML += ("<option value='" + val.taskCode + "'>" + val.taskText + "</option>");
                }
            });
            strHTML += '</select></div ></div >';
            $('#mpSectionArea').append(strHTML);
        }
        $('#mpSectionArea select:last').focus();
    });

    $('#more_insptask').click(function (e) {
        lastValue = $('#inspTaskArea select:last').val();
        if (lastValue != undefined && lastValue != "") {
            var strHTML = ""
            strHTML = ('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><select class="form-control" name="c_insptask[]">');
            $(inspectSpecials).each(function (index, val) {
                if (val == '') {
                    strHTML += ("<option value='" + val.inspectValue + "' selected>" + val.inspectText + "</option>");
                } else {
                    strHTML += ("<option value='" + val.inspectValue + "'>" + val.inspectText + "</option>");
                }
            });
            strHTML += '</select></div ></div >';
            $('#inspTaskArea').append(strHTML);
        }
        $('#inspTaskArea select:last').focus();
    });

    $('#more_tgintervaloffsetnote').click(function (e) {
        lastValue = $('#tgintervaloffsetnoteArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#tgintervaloffsetnoteArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_tgintervaloffsetnote[]" placeholder="TG Interval/Offset Note" value="" /></div></div>');
        }
        $('#tgintervaloffsetnoteArea input:last').focus();
    });

    $('#more_tgdepending').click(function (e) {
        lastValue = $('#tgdependingArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#tgdependingArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_tgdepending[]" placeholder="Depending" value="" /></div></div>');
        }
        $('#tgdependingArea input:last').focus();
    });

    $('#more_mpdoffsetsample').click(function (e) {
        lastValue = $('#mpdoffsetsampleArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#mpdoffsetsampleArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="cmpdoffsetsample[]" placeholder="MPD/OEM Task Offset Sample" value="" /></div></div>');
        }
        $('#mpdoffsetsampleArea input:last').focus();
    });

    $('#more_mpdintervalsample').click(function (e) {
        lastValue = $('#mpdintervalsampleArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#mpdintervalsampleArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdintervalsample[]" placeholder="MPD/OEM Task Interval Sample" value="" /></div></div>');
        }
        $('#mpdintervalsampleArea input:last').focus();
    });

    $('#more_tgtaskoffsetsample').click(function (e) {
        lastValue = $('#tgtaskoffsetsampleArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#tgtaskoffsetsampleArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="ctgtaskoffsetsample[]" placeholder="TG Task Offset Sample" value="" /></div></div>');
        }
        $('#tgtaskoffsetsampleArea input:last').focus();
    });

    $('#more_tgtasklimitsample').click(function (e) {
        lastValue = $('#tgtasklimitsampleArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#tgtasklimitsampleArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="ctgtasklimitsample[]" placeholder="TG Task Interval Sample" value="" /></div></div>');
        }
        $('#tgtasklimitsampleArea input:last').focus();
    });

    $('#more_mpdengineeff').click(function (e) {
        lastValue = $('#mpdengineeffArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#mpdengineeffArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdengineeff[]" placeholder="MPD Engine Effectivity" value="" /></div></div>');
        }
        $('#mpdengineeffArea input:last').focus();
    });

    $('#more_mpdaircrafteff').click(function (e) {
        lastValue = $('#mpdaircrafteffArea input:last').val();
        if (lastValue != undefined && lastValue != "") {
            $('#mpdaircrafteffArea').append('<div class="form-row"><div class="col-md-4">&nbsp;</div><div class="col-md-8 p-1"><input type="text" class="form-control" name="c_mpdaircrafteff[]" placeholder="MPD Aircraft Effectivity" value="" /></div></div>');
        }
        $('#mpdaircrafteffArea input:last').focus();
    });
   
    $('#fileupload').fileupload({
        url: 'DocUploadHandler.ashx',        
        dataType: 'json',
        done: function (event, data) {            
            console.log(data);

            if (data.textStatus && data.textStatus == 'success') {
                $.each(data.files, function (index, file) {
                    var htmlRow = "<tr>";
                    var appIcon;
                    var application;
                    var fileName = data.result.fullFileName;
                    var extension = file.name.substr(file.name.lastIndexOf(".") + 1).toUpperCase();
                    switch (extension) {
                        case 'PDF': appIcon = "far fa-file-pdf "; application = "Acrobat Reader"; break;
                        case 'DOC': appIcon = "far fa-file-word "; application = "MS WinWord"; break;
                        case 'DOCX': appIcon = "far fa-file-word "; application = "MS WinWord"; break;
                        case 'WWI': appIcon = "far fa-file-word "; application = "MS WinWord"; break;
                        case 'MPP': appIcon = "far fa-file-invoice "; application = "MS Project"; break;
                        case 'XLS': appIcon = "far fa-file-excel "; application = "MS Excel"; break;
                        case 'XLSX': appIcon = "far fa-file-excel "; application = "MS Excel"; break;
                        case 'TXT': appIcon = "far fa-file-alt "; application = "Text File"; break;
                        case 'PPT': appIcon = "far fa-file-powerpoint "; application = "MS Powerpoint"; break;
                        case 'JPG': appIcon = "far fa-file-image "; application = "JPEG Image"; break;
                        case 'PNG': appIcon = "far fa-file-image "; application = "GIF Image"; break;
                        case 'GRF': appIcon = "far fa-file-image "; application = "Graphic File"; break;
                        case 'SND': appIcon = "far fa-file-audio "; application = "Sound File"; break;
                        case 'ACD': appIcon = "far fa-file-contract "; application = "Autocad"; break;
                        case 'ZIP': appIcon = "far fa-file-archive "; application = "Compressed DocCreate J/C files"; break;
                        default: appIcon = "far fa-file "; application = "N/A"; break;
                    }
                    var lockIcon = "fas fa-lock-open ";
                    htmlRow += "<td align='center'><i class='" + appIcon + " fa-2x'></i></td><td align='left'>" + application + "</td><td>" + file.name + "</td><td align='center'><i class='" + lockIcon + " fa-2x'></i></td><td align='center'><button type='button' class='btn-sm btn-light'><i class='fas fa-glasses'></i></button><button type='button' class='btn-sm btn-danger'><i class='fas fa-trash-alt'></i></button></td>";
                    htmlRow += "</tr>";

                    attachmentList.push({ "application": extension, "origFile": fileName, "docFile": fileName, "applicationID": '', "fileID": '', "checkedIN": '', "updateStatus": 'N' });
                    $('#attachmentTab tbody').append(htmlRow);
                });
            }
        },
        progressall: function (e, data) {
            var progress = parseInt(data.loaded / data.total * 100, 10);
            $('#progress .progress-bar').css(
                'width',
                progress + '%'
            );
        }
    }).prop('disabled', !$.support.fileInput).parent().addClass($.support.fileInput ? undefined: 'disabled');
</script>
<!-- End Java Script -->
</html>