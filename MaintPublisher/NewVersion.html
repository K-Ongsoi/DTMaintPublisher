<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Technical Department : Document Editor Page">
    <meta name="author" content="Keerati Ongsoi" />

    <title>THAI - Technical Department : Document Editor Page</title>
    <link rel="icon" href="images/favicon.png" />
    <link href="framework/bootstrap4/css/bootstrap.min.css" rel="stylesheet" />
    <link href="framework/css/all.css" rel="stylesheet" />
    <link href="style/fonts.css" rel="stylesheet" />
    <link href="style/master.css" rel="stylesheet" />
    <link href="framework/bootstrap4/css/open-iconic-bootstrap.css" rel="stylesheet" />
    <link href="framework/bootstrap4/css/bootstrap-multiselect.css" rel="stylesheet" />
</head>
<body>
    <nav class="navbar sticky-top flex-md-nowrap p-0" role="navigation">
        <a class="navbar-brand" href="#"><img src="images/LightLogo.png" /></a>
        <div class="col-sm-2 col-md-2 mr-0 navbar page-title" style="float: left;">Document Editors</div>
        <div class="w-100" style="align-content:center;text-align:center;"><img src="images/DarkLogo.png" style="vertical-align: central;" />TECHNICAL DEPARTMENT</div>
        <div class="col-sm-2 col-md-2">
            <div class="navbar-nav px-2" style="float:right;">
                <a href="#" role="button"><i class="fas fa-user-circle" style="vertical-align:middle;color:#808080;"></i><span class="user-name">&nbsp; Keerati Ongsoi</span></a>                
            </div>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <nav class="d-none d-md-block bg-light sidebar">
                <div class="sidebar-sticky">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" title="Document Editor">
                                <span data-feather="home"></span>
                                <i class="far fa-clipboard fa-2x"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" title="Log out">
                                <span data-feather="file"></span>
                                <i class="fas fa-sign-out-alt fa-2x"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <main role="main" class="main col-md-11 ml-sm-auto col-lg-12 pt-0 px-5 mh-100 h-100" style="position:page;">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap border-bottom">
                <nav class="nav" style="float:left;">
                    <a class="nav-link" href="DocEditor.html"><i class="far fa-file"></i> New Document</a>
                    <a class="nav-link active" href="#"><i class="far fa-copy"></i> New Revision</a>
                </nav>
            </div>
            <span class="pageTitle"><i class="far fa-copy"></i> New Revision</span>
            <div class="container-fluid h-100">
                <div class="row mw-100 h-100">
                    <div class="col-md-6 p-2">
                        <div class="card mw-100 main_content">
                            <div class="card-body">
                                <form class="p-1">
                                    <div class="form-row">
                                        <div class="col-auto ml-md-auto">
                                            <label>Document Status:&nbsp;</label><span class="badge badge-success">CREATED</span>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-8">
                                            <div class="form-group">
                                                <label for="documentNo">Document Number</label>
                                                <input type="text" class="form-control" id="documentNo" placeholder="Document Number" readonly/>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="documentPart">Part</label>
                                                <input type="text" class="form-control" id="documentPart" placeholder="Part" readonly/>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="documentVersion">Version</label>
                                                <input type="number" class="form-control" id="documentVersion" placeholder="Version" value="00" readonly />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-6 mr-md-auto">
                                            <div class="form-group">
                                                <label for="labOffice">Lab Office</label>
                                                <input type="text" class="form-control" id="labOffice" placeholder="Lab Office" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col mw-100">
                                            <div class="form-group">
                                                <label for="documentDesc">Description</label>
                                                <textarea class="form-control" id="documentDesc" rows="10"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col mw-100">
                                            <div class="form-group">
                                                <div>Originals:</div>
                                                <div class="table-responsive-sm" id="originalDocs">
                                                    <table class="table table-striped table-hover">                                                        
                                                        <thead class="thead-light">                                                            
                                                            <tr>
                                                                <th width="5%">APPL.</th>
                                                                <th width="*">Application</th>
                                                                <th width="15%">Storage Cat.</th>
                                                                <th width="12%"></th>
                                                            </tr>
                                                        </thead>                                                        
                                                        <tbody>
                                                            <tr>
                                                                <td align="center"><i class="far fa-file-word fa-2x"></i></td>
                                                                <td>Word-Document.doc</td>
                                                                <td align="center">A</td>
                                                                <td align="center"><button type="button" class="btn-sm btn-light"><i class="fas fa-glasses"></i></button><button type="button" class="btn-sm btn-danger"><i class="fas fa-trash-alt"></i></button></td>
                                                            </tr>
                                                            <tr>
                                                                <td align="center"><i class="far fa-file-pdf fa-2x"></i></td>
                                                                <td>PDF-Document.pdf</td>
                                                                <td align="center">A</td>
                                                                <td align="center"><button type="button" class="btn-sm btn-light"><i class="fas fa-glasses"></i></button><button type="button" class="btn-sm btn-danger"><i class="fas fa-trash-alt"></i></button></td>
                                                            </tr>
                                                            <tr>
                                                                <td align="center"><i class="far fa-file-excel fa-2x"></i></td>
                                                                <td>Excel-Document.xlsx</td>
                                                                <td align="center">A</td>
                                                                <td align="center"><button type="button" class="btn-sm btn-light"><i class="fas fa-glasses"></i></button><button type="button" class="btn-sm btn-danger"><i class="fas fa-trash-alt"></i></button></td>
                                                            </tr>
                                                        </tbody>
                                                        <tfoot>
                                                            <tr>
                                                                <td colspan="3">                                                                    
                                                                    <button type="button" class="btn btn-outline-secondary"><i class="fas fa-file-import"></i></button>                                                                   
                                                                </td>
                                                            </tr>
                                                        </tfoot>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="card-footer">
                                <button type="button" class="btn btn-outline-primary"><i class="far fa-save"></i> Save</button>
                                <button type="button" class="btn btn-outline-danger"><i class="fas fa-undo"></i> Cancel</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 ml-md-auto p-2">
                        <div class="card mw-100 main_content">
                            <div class="card-header bg-warning">Additional Data</div>
                            <div class="card-body scrollable">
                                <form>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Aircraft Model:</label></div>
                                        <div class="col-md-8 p-1"><select class="mw-100 w-100" id="acModel" multiple="multiple"> </select></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Revision No.:</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Revision No." /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Revision/Edition/Issue Date:</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Revision/Edition/Issue Date" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Revision Code of Original Task:</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Revision Code" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>A/C Zone:</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Aircraft Zonal" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MP Task Source</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MP Task Source" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MP Task Section</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MP Task Section" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Percentage of Sampling Inspect</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Percentage of Sampling Inspect" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Work Type</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Work Type" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Spec. Ident. Inspection Task</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Spec. Ident. Inspection Task" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Original MP Task Number</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Original MP Task Number" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG MP Task Number</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="TG MP Task Number" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Beginning Effective Date</label></div>
                                        <div class="col-md-8 p-1"><input type="date" class="form-control" data-date-format="DD.MM.YYYY" placeholder="Beginning Effective Date"/></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MP Task Status</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MP Task Status" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MP Task MH</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MP Task MH" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Access Panel Information</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Access Panel Information" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MPD/OEM Task Offset</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MPD/OEM Task Offset" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MPD/OEM Task Limit/Interval</label></div>
                                        <div class="col-md-8 p-1 form-inline"><input type="number" class="form-control col-sm-8" placeholder="MPD/OEM Task Limit/Interval" /><select class="form-control col-sm-4" id="MPDInterval"></select></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MPD/OEM Task Offset Sample</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MPD/OEM Task Offset Sample" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MPD/OEM Task Interval Sample</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MPD/OEM Task Interval Sample" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG Task Offset</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="TG Task Offset" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG Task Limit/Interval</label></div>
                                        <div class="col-md-8 p-1 form-inline"><input type="number" class="form-control col-sm-8" placeholder="TG Task Limit/Interval" /><select class="form-control col-sm-4" id="TGInterval"></select></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG Task Offset Sample</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="TG Task Offset Sample" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG Task Interval Sample</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="TG Task Interval Sample" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MPD Engine Effectivity</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MPD Engine Effectivity" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MPD Aircraft Effectivity</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MPD Engine Effectivity" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG Aircraft Effectivity:</label></div>
                                        <div class="col-md-8 p-1"><select class="mw-100 w-100" id="TG_ACEff" multiple="multiple"> </select></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>MPD Reference</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="MPD Reference" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Other Reference</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Other Reference" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Detectability Code</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Detectability Code" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Insp. Report Req.</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Insp. Report Req." /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>TG Interval/Offset Note</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="TG Interval/Offset Note" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Depending</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Depending" /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Reason of Add/Del./Rev.</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Reason of Add/Del./Rev." /></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-md-4"><label>Engineering Note</label></div>
                                        <div class="col-md-8 p-1"><input type="text" class="form-control" placeholder="Engineering Note" /></div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <div class="modal fade" id="DocumentSelector" tabindex="-1" role="dialog" aria-labelledby="DocumentSelector" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="far fa-clone"></i>Select Document</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body p-0">
                    <div class="container-fluid">
                        <div class="row p-0">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="s_documentNumber">Document</label>
                                    <input type="number" class="form-control" id="s_documentNumber" placeholder="Version" value="00" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="s_documentPart">Part</label>
                                    <input type="number" class="form-control" id="s_documentPart" placeholder="Version" value="00" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="s_documentVersion">Version</label>
                                    <input type="number" class="form-control" id="s_documentVersion" placeholder="Version" value="00" />
                                </div>
                            </div>
                            <div class="col-md-2" style="vertical-align:text-bottom;">
                                <button type="button" class="btn-sm btn-outline-secondary" style="vertical-align:text-bottom;margin-top: 30px;"><i class="fas fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="container-fluid col-md-12" id="resultDocs">
                        <select id="selectDocuments" class="form-control" multiple>
                            <option value="0810000101-TG01|380|00">   
                                <div class="row">
                                    <div class="col-xs-6">0810000101-TG01</div>
                                    <div class="col-xs-3">380</div>
                                    <div class="col-xs-3">00</div>
                                </div>
                            </option>
                            <option value="122112100807TG|787|02">
                                <div class="row">
                                    <div class="col-xs-6">122112100807TG</div>
                                    <div class="col-xs-3">787</div>
                                    <div class="col-xs-3">02</div>
                                </div>
                            </option>
                            <option value="200253-00001-01|380|09">
                                <div class="row">
                                    <div class="col-xs-6">200253-00001-01</div>
                                    <div class="col-xs-3">380</div>
                                    <div class="col-xs-3">09</div>
                                </div>
                            </option>                            
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-outline-primary" id="selectDocAction">Select</button>
                </div>
            </div>
        </div>
    </div>
</body>
<!-- Java Script Section -->
<script src="framework/jquery-3.3.1.min.js"></script>
<script src="framework/bootstrap4/js/popper.min.js"></script>
<script src="framework/bootstrap4/js/bootstrap.min.js"></script>
<script src="framework/bootstrap4/js/bootstrap-multiselect.js"></script>
<script>
    var acModel = [];
    var selected = [];
    var intervalUnits = [];

    function getIntervalUnit() {
        $.ajax({
            type: 'POST',
            url: 'DocumentWS.asmx/GetIntervalUnit',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            success: function (response) {
                var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);
                $(jsonData).each(function (index, value) {
                    intervalUnits.push(value);
                });

                $('#MPDInterval').empty();
                $('#TGInterval').empty();

                $(intervalUnits).each(function (index, value) {
                    $('#MPDInterval').append("<option value='" + value + "'>" + value + "</option>");
                    $('#TGInterval').append("<option value='" + value + "'>" + value + "</option>");
                });
            }
        });
    }

    function getAircraftModel() {
        $.ajax({
            type: 'POST',
            url: 'DocumentWS.asmx/GetAircraftModel',
            contentType: "application/json; charset=utf-8",
            dataType: 'json',
            success: function (response) {
                var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);
                $(jsonData).each(function (index, value) {
                    acModel.push(value);
                });
                renderAcModel();                
            }
        });
    }

    function renderAircraftEff() {        
        $('#TG_ACEff').empty();
        $(selected).each(function (i, item) {           
            var jsonRequest = '{model : ' + JSON.stringify(item.value) + '}';
            $.ajax({
                type: 'POST',
                url: 'DocumentWS.asmx/GetAircrafts',
                contentType: "application/json; charset=utf-8",
                dataType: 'json',
                data: jsonRequest,
                success: function (response) {
                    var jsonData = (response.d) ? $.parseJSON(response.d) : $.parseJSON(response);
                    $('#TG_ACEff').append("<optgroup label='" + item.value + "'>");
                    $(jsonData).each(function (index, value) {
                        $('#TG_ACEff').append("<option value='" + value + "'>" + value + "</option>");
                    });
                    $('#TG_ACEff').append("</optgroup>");
                    $('#TG_ACEff').multiselect('destroy');
                    $('#TG_ACEff').multiselect({
                        nonSelectedText: 'Please select an aircraft',
                        enableClickableOptGroups: true,
                        enableCollapsibleOptGroups: true,
                        enableFiltering: true,
                        buttonWidth: '100%'
                    });
                }
            });                        
        });               
    }

    function renderAcModel() {
        $(acModel).each(function (item, value) {
            $('#acModel').append("<option value='" + value + "'>" + value + "</option>");
        });
        $('#acModel').multiselect({            
            nonSelectedText: 'Please select aircraft model',
            onChange: function (element, checked) {
                var fleetModel = $('#acModel option:selected');
                selected = [];
                $(fleetModel).each(function (index, model) {
                    selected.push(model);
                });
                renderAircraftEff();
            },
            buttonWidth: '100%'
        });
    }

    $(document).ready(function () {
        getIntervalUnit();
        getAircraftModel();

        $('[data-toggle="tooltip"]').tooltip();

        $('#TG_ACEff').multiselect({
            nonSelectedText: 'Please select an aircraft',
            enableClickableOptGroups: true,
            enableCollapsibleOptGroups: true,
            enableFiltering: true,
            buttonWidth: '100%'
        });        

        $("#s_documentNumber").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#selectDocuments option").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });

        $("#s_documentPart").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#selectDocuments option").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });

        $('#selectDocAction').click(function () {
            var selectedDoc = $('#selectDocuments').find(":selected").val();

            if (selectedDoc != undefined) {
                var arr = selectedDoc.split("|");
                $('#documentNo').val(arr[0]);
                $('#documentPart').val(arr[1]);
                var i_rev = parseInt(arr[2]);
                i_rev++;
                if (i_rev <= 9) {
                    $('#documentVersion').val('0' + i_rev);
                }
                else {
                    $('#documentVersion').val(i_rev);
                }

                $('#DocumentSelector').modal('hide');
            }
            else {
                alert("Please select an existing document!");
                return;
            }
        });

        $('#DocumentSelector').modal('show');
    });
</script>
<!-- End Java Script -->
</html>